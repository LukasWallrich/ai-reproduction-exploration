---
title: "Reproduction Report: Bimber et al. (2014)"
subtitle: "Digital Media and Political Participation: The Moderating Role of Political Interest Across Acts and Over Time"
author: "AI Reproduction"
date: today
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    code-summary: "Show code"
    embed-resources: true
keep-md: true
execute:
  warning: false
  message: false
  cache: false
---

::: {.callout-warning appearance="simple"}
## Exploratory AI Capability Study

This report was generated autonomously by an AI agent as part of an exploratory study into the capabilities of agentic AI for computational reproduction. **It is not an independent assessment of the original paper.** The AI agent may have made errors in data processing, analytical decisions, or interpretation. Any discrepancies reported here may reflect limitations of the AI reproduction process rather than issues with the original research.
:::

```{r setup}
#| label: setup
#| include: false

library(MASS)  # Load before tidyverse to avoid masking select/filter
library(tidyverse)
library(knitr)
library(kableExtra)
library(haven)

set.seed(12345)

# Helper function for deviation classification
classify_deviation <- function(paper_value, reproduced_value, paper_decimals = NULL,
                               significant = NULL) {
  abs_dev <- abs(reproduced_value - paper_value)

  if (is.null(paper_decimals)) {
    pv_str <- sub("0+$", "", format(paper_value, scientific = FALSE, nsmall = 10))
    if (grepl("\\.", pv_str)) {
      paper_decimals <- nchar(sub(".*\\.", "", pv_str))
    } else {
      paper_decimals <- 0
    }
  }

  rounds_same <- round(reproduced_value, paper_decimals) == round(paper_value, paper_decimals)

  use_near_zero_rule <- abs(paper_value) < 0.2 && !isTRUE(significant)

  if (use_near_zero_rule) {
    rel_dev <- NA_real_
    category <- case_when(
      rounds_same ~ "Exact",
      abs_dev <= 0.01 ~ "Minor deviation",
      TRUE ~ "Substantive deviation"
    )
  } else {
    rel_dev <- abs_dev / abs(paper_value) * 100
    category <- case_when(
      rounds_same ~ "Exact",
      rel_dev <= 5 ~ "Minor deviation",
      TRUE ~ "Substantive deviation"
    )
  }
  tibble(
    abs_deviation = abs_dev,
    rel_deviation_pct = rel_dev,
    category = category
  )
}

style_deviation <- function(category) {
  colors <- c(
    "Exact" = "#d4edda",
    "Minor deviation" = "#fff3cd",
    "Substantive deviation" = "#f8d7da",
    "Conclusion change" = "#f5c6cb"
  )
  bg <- colors[category]
  if (is.na(bg)) bg <- "#ffffff"
  paste0("background-color: ", bg, ";")
}
```

::: {.callout-note appearance="minimal"}
## Abstract

**Paper**: Bimber, B., Cantijoch Cunill, M., Copeland, L., & Gibson, R. (2014). Digital Media and Political Participation: The Moderating Role of Political Interest Across Acts and Over Time. *Social Science Computer Review*, 1-22. DOI: 10.1177/0894439314526559

**Data**: British Election Studies (BES) cross-sectional surveys 2001, 2005, 2010. N ranges from ~1,463 to ~3,595 depending on year and outcome.

**Verdict**: PARTIALLY REPRODUCED

All three claims were tested across 60 deviation log parameters covering Tables 2-5 for all three survey years. Claim 1 (digital media associated with political talk for low-interest citizens) is qualitatively reproduced: all interaction terms match in direction and significance. Claim 2 (voting relationship strengthening over time) is qualitatively reproduced with caveats: the 2001 Internet info OR becomes significant in our reproduction (strengthening the claim) and the 2001 interaction OR shows a direction reversal across 1.0, though this term is non-significant in both the paper and reproduction. Claim 3 (variable moderating effect for elite-directed acts) is only partially reproduced: while the general pattern of variability is present, 6 of 8 conclusion changes occur on Claim 3 parameters, with the 2001 donating interaction losing significance and the 2001 working-for-party interaction gaining significance in our reproduction. Deviations are concentrated in the 2001 data, possibly due to differences in weight variable selection or internet use coding for the mailback questionnaire subsample. Results for 2005 and especially 2010 are closely reproduced.
:::

## Open Materials

| Material | Available | Location |
|----------|-----------|----------|
| Supplementary materials | No | — |
| Replication code | No | — |
| Replication data (processed) | No | — |
| Raw data | Yes | UK Data Service (BES 2001, 2005, 2010) |

No replication materials were found. The reproduction relies entirely on the paper's description of methods and the raw BES data files.

---

## Paper Overview

### Research Question
How does political interest moderate the relationship between digital media use and traditional forms of political participation across different types of political acts and over time?

### Key Methods
- Cross-sectional survey data from BES 2001, 2005, and 2010
- Logistic regression for voting (binary DV)
- OLS regression for donating money and discussing politics (0-10 scales)
- Negative binomial regression for working for a party (0-10 scale with many zeros)
- Separate models for each year, with main effects and interaction models
- All analyses weighted to reflect general population parameters

### Claims from the Abstract

1. Digital media use is positively and consistently associated with political talk for those lower in political interest.
2. For voting, a similar relationship that appears to be strengthening over time.
3. For the elite-directed acts of donating money and working for a party, a highly variable moderating effect of political interest that can be positive, negative, or nonexistent.

---

## Data and Variable Construction

```{r load-data}
#| label: load-data

# ============================================================
# Load BES 2001
# ============================================================
bes2001_raw <- read_por("data/bes_2001.por")

bes2001 <- bes2001_raw %>%
  transmute(
    # Education: Age completed full-time education (1-5 scale)
    education = case_when(
      as.numeric(BQ75B) %in% 1:5 ~ as.numeric(BQ75B),
      as.numeric(BQ75B) == 6 ~ 5,  # Still in school -> highest category
      TRUE ~ NA_real_
    ),
    # Age
    age = ifelse(as.numeric(AGEALL) >= 18 & as.numeric(AGEALL) <= 98,
                 as.numeric(AGEALL), NA_real_),
    # Income (1-12 in 2001)
    income = ifelse(as.numeric(INCOMES) %in% 1:12, as.numeric(INCOMES), NA_real_),
    # Male (1=Male, 0=Female)
    male = case_when(
      as.numeric(GENALL) == 1 ~ 1,
      as.numeric(GENALL) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Party contact (BQ62: Knocked Up By Party on election day)
    party_contact = case_when(
      as.numeric(BQ62) == 1 ~ 1,
      as.numeric(BQ62) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Political efficacy (0-10 scale)
    pol_efficacy = ifelse(as.numeric(BQ58) %in% 0:10, as.numeric(BQ58), NA_real_),
    # Political interest (reverse code: 1=great deal...5=none -> 0=none...4=great deal)
    pol_interest = case_when(
      as.numeric(BQ1) %in% 1:5 ~ 5 - as.numeric(BQ1),
      TRUE ~ NA_real_
    ),
    # Internet use for political info (reverse code)
    # CQ6: 1=Great deal, 2=Fair amount, 3=Not very much, 4=Not at all
    # Non-internet users (CQ5=2) get 0
    internet_info = case_when(
      as.numeric(CQ5) == 2 ~ 0,  # No internet -> 0
      as.numeric(CQ6) %in% 1:4 ~ 4 - as.numeric(CQ6),  # Reverse code
      TRUE ~ NA_real_
    ),
    # Vote (1=voted, 0=didn't vote)
    vote = case_when(
      as.numeric(BQ8A) == 1 ~ 1,
      as.numeric(BQ8A) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Work for party (0-10)
    work_party = ifelse(as.numeric(BQ41H) %in% 0:10, as.numeric(BQ41H), NA_real_),
    # Donate money (0-10)
    donate = ifelse(as.numeric(BQ41F) %in% 0:10, as.numeric(BQ41F), NA_real_),
    # Discuss politics (0-10)
    discuss = ifelse(as.numeric(BQ41I) %in% 0:10, as.numeric(BQ41I), NA_real_),
    # Weight - use mailback weight since internet variable comes from mailback
    weight = as.numeric(MAILWGT)
  )

# ============================================================
# Load BES 2005
# ============================================================
bes2005_raw <- read_sav("data/bes_2005_face-to-face.sav")

bes2005 <- bes2005_raw %>%
  transmute(
    # Education: Age finished education (tq81: 1-5, with 6-7 still in school)
    education = case_when(
      as.numeric(tq81) %in% 1:5 ~ as.numeric(tq81),
      as.numeric(tq81) %in% 6:7 ~ 5,  # Still in education -> highest
      TRUE ~ NA_real_
    ),
    # Age
    age = ifelse(as.numeric(tq77) >= 18 & as.numeric(tq77) <= 97,
                 as.numeric(tq77), NA_real_),
    # Income (1-13 in 2005)
    income = ifelse(as.numeric(tq84) %in% 1:13, as.numeric(tq84), NA_real_),
    # Male
    male = case_when(
      as.numeric(tq76) == 1 ~ 1,
      as.numeric(tq76) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Party contact on election day
    party_contact = case_when(
      as.numeric(bq71a) == 1 ~ 1,
      as.numeric(bq71a) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Political efficacy (0-10)
    pol_efficacy = ifelse(as.numeric(bq61) %in% 0:10, as.numeric(bq61), NA_real_),
    # Political interest (reverse code from 1-5 to 0-4)
    pol_interest = case_when(
      as.numeric(bq1) %in% 1:5 ~ 5 - as.numeric(bq1),
      TRUE ~ NA_real_
    ),
    # Internet use for political info (reverse code from 1-4 to 0-3)
    # bq73: 1=Great deal ... 4=Not at all
    # Check if non-internet users (bq110=2) should be coded 0
    internet_info = case_when(
      as.numeric(bq110) == 2 ~ 0,  # No internet access -> 0
      as.numeric(bq73) %in% 1:4 ~ 4 - as.numeric(bq73),
      TRUE ~ NA_real_
    ),
    # Vote
    vote = case_when(
      as.numeric(bq12a) == 1 ~ 1,
      as.numeric(bq12a) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Work for party (0-10)
    work_party = ifelse(as.numeric(bq49i) %in% 0:10, as.numeric(bq49i), NA_real_),
    # Donate money (0-10)
    donate = ifelse(as.numeric(bq49g) %in% 0:10, as.numeric(bq49g), NA_real_),
    # Discuss politics (0-10)
    discuss = ifelse(as.numeric(bq49j) %in% 0:10, as.numeric(bq49j), NA_real_),
    # Weight - post-wave weight for cross-sectional analysis
    weight = as.numeric(postwtbr)
  )

# ============================================================
# Load BES 2010
# ============================================================
bes2010_raw <- read_sav("data/bes_2010_survey_data.sav")

bes2010 <- bes2010_raw %>%
  transmute(
    # Education: Combine post-wave (bq95_1) and pre-wave (aq67) for better coverage
    education = case_when(
      as.numeric(bq95_1) %in% 1:5 ~ as.numeric(bq95_1),
      as.numeric(bq95_1) %in% 6:7 ~ 5,
      as.numeric(aq67) %in% 1:5 ~ as.numeric(aq67),
      as.numeric(aq67) %in% 6:7 ~ 5,
      TRUE ~ NA_real_
    ),
    # Age: combine post-wave and pre-wave
    age = case_when(
      as.numeric(bq89) >= 18 & as.numeric(bq89) <= 99 ~ as.numeric(bq89),
      as.numeric(aq63) >= 18 & as.numeric(aq63) <= 99 ~ as.numeric(aq63),
      TRUE ~ NA_real_
    ),
    # Income: combine post-wave (bq96) and pre-wave (aq70) for better coverage
    income = case_when(
      as.numeric(bq96) %in% 1:15 ~ as.numeric(bq96),
      as.numeric(aq70) %in% 1:15 ~ as.numeric(aq70),
      TRUE ~ NA_real_
    ),
    # Male
    male = case_when(
      as.numeric(bq88) == 1 ~ 1,
      as.numeric(bq88) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Party contact - use general campaign contact (bq86_1) as paper's mean (0.53)
    # matches this variable, not election day contact (bq87_1 gives ~0.06)
    party_contact = case_when(
      as.numeric(bq86_1) == 1 ~ 1,
      as.numeric(bq86_1) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Political efficacy (0-10)
    pol_efficacy = ifelse(as.numeric(bq59) %in% 0:10, as.numeric(bq59), NA_real_),
    # Political interest (reverse code)
    pol_interest = case_when(
      as.numeric(bq1) %in% 1:5 ~ 5 - as.numeric(bq1),
      TRUE ~ NA_real_
    ),
    # Internet use for political info (reverse code from 1-4 to 0-3)
    internet_info = case_when(
      as.numeric(bq84_1) %in% 1:4 ~ 4 - as.numeric(bq84_1),
      TRUE ~ NA_real_
    ),
    # Vote
    vote = case_when(
      as.numeric(bq12_1) == 1 ~ 1,
      as.numeric(bq12_1) == 2 ~ 0,
      TRUE ~ NA_real_
    ),
    # Work for party (0-10)
    work_party = ifelse(as.numeric(bq53_6) %in% 0:10, as.numeric(bq53_6), NA_real_),
    # Donate money (0-10)
    donate = ifelse(as.numeric(bq53_5) %in% 0:10, as.numeric(bq53_5), NA_real_),
    # Discuss politics (0-10)
    discuss = ifelse(as.numeric(bq53_9) %in% 0:10, as.numeric(bq53_9), NA_real_),
    # Weight - post-wave weight
    weight = as.numeric(postwgt)
  )

# Combine into a list for easier iteration
datasets <- list("2001" = bes2001, "2005" = bes2005, "2010" = bes2010)

# Show dataset overview
map_dfr(names(datasets), function(yr) {
  d <- datasets[[yr]]
  tibble(
    Year = yr,
    `Total N` = nrow(d),
    `Complete cases (all vars)` = sum(complete.cases(d[, setdiff(names(d), "weight")]))
  )
}) %>%
  kable(caption = "Dataset Overview") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

The paper uses BES cross-sectional survey data from three elections. Variables are constructed as follows:

- **Education**: Age at which respondent completed full-time education, coded 1 (15 or younger) to 5 (19 or older). Those still in education are coded as 5.
- **Age**: Respondent's age in years.
- **Income**: Annual household income on a categorical scale (1-12 in 2001, 1-13 in 2005, 1-15 in 2010).
- **Male**: Binary (1 = male, 0 = female).
- **Party contact**: Whether any political party contacted the respondent on election day (binary). In 2001, the BES variable is "Knocked Up By Party" (election day contact). In 2005 and 2010, it explicitly asks about contact on election day.
- **Political efficacy**: Self-assessed influence on politics and public affairs (0-10 scale).
- **Political interest**: General interest in politics, reverse-coded to 0 (none at all) to 4 (a great deal).
- **Internet information**: Frequency of using the Internet for election information, reverse-coded to 0 (not at all) to 3 (a great deal). Non-internet users are coded as 0.
- **Dependent variables**: Vote (binary), work for party (0-10), donate money (0-10), discuss politics (0-10).

---

## Analytical Decisions and Assumptions

| Decision | Paper says | Our interpretation | Rationale | Alternative possible |
|----------|-----------|-------------------|-----------|---------------------|
| Weight variable (2001) | "Weighted per BES specs" | Used `MAILWGT` (mailback weight) | Internet use variable comes from the mailback questionnaire; mailback weight adjusts for non-response in this component | Could use `POSTOCTW` (post-election cross-section weight) |
| Weight variable (2005) | "Weighted per BES specs" | Used `postwtbr` (post-wave calibrated weight) | Standard post-election cross-section weight | Could use `panwtbr` (panel weight) |
| Weight variable (2010) | "Weighted per BES specs" | Used `postwgt` (post cross-section weight) | Standard post-election cross-section weight | Could use `mailwgt` |
| Non-internet users | Not explicitly stated | Coded as 0 on internet info scale | Non-internet users cannot use internet for election info | Could be coded as NA (excluded) |
| Education: still in school | Not mentioned | Coded as 5 (highest category) | Students are pursuing education beyond 19 | Could exclude or code differently |
| Party contact (2001) | Footnote: "Were you telephoned by a Canvasser?" | Used `BQ62` (Knocked Up By Party) - election day contact | Paper's main description says "election day" contact; BQ62 is the election day measure | Could use `BQ61` (phoned during campaign) |
| Party contact (2010) | Election day contact | Used `bq86_1` (general campaign contact) | Paper's Table 1 descriptive (mean ~0.53) matches `bq86_1` (0.55) much better than `bq87_1` (0.06) | Could use `bq87_1` (election day contact) |
| Internet use (2005) | 0-3 scale | Non-internet users (`bq110=2`) coded as 0 | Consistent with the coding logic for 2001 | Could code all who answered 4 (not at all) as 0 regardless of internet access |
| Education/Age/Income (2010) | Not mentioned | Combined pre-wave (`aq67`, `aq63`, `aq70`) and post-wave (`bq95_1`, `bq89`, `bq96`) variables | Post-wave variables alone yield N~1,143 (far below paper's ~2,300); combining recovers N~2,358 | Use post-wave only (too many missing cases) |
| Logistic regression output | "Odds ratios with standard errors" | Exponentiated coefficients and SEs on the odds ratio scale | Paper explicitly states "Cell entries are odds ratios" | SEs could be on log-odds scale |

**Flagged analytical choices in the original paper:**

1. OLS regression is used for bounded 0-10 ordinal scales (donating, discussing politics), which may not meet OLS assumptions. The authors note they tested ordered logit and negative binomial alternatives.
2. No correction for multiple comparisons across 24 models.
3. The interaction term in logistic regression (Table 2) is reported as an odds ratio, which does not straightforwardly correspond to moderation on the probability scale.

---

## Descriptive Statistics Comparison

```{r descriptives}
#| label: descriptives

# Compute descriptive statistics and compare to Table 1
compute_desc <- function(d, year) {
  vars <- c("education", "age", "income", "male", "party_contact",
            "pol_efficacy", "pol_interest", "internet_info",
            "vote", "work_party", "donate", "discuss")

  map_dfr(vars, function(v) {
    x <- d[[v]]
    x <- x[!is.na(x)]
    tibble(
      Variable = v,
      Year = year,
      Mean = mean(x),
      SD = sd(x),
      Min = min(x),
      Max = max(x),
      N = length(x)
    )
  })
}

desc_all <- map_dfr(names(datasets), function(yr) {
  compute_desc(datasets[[yr]], yr)
})

# Paper's Table 1 values
paper_desc <- tribble(
  ~Variable, ~Year, ~Paper_Mean, ~Paper_SD,
  "education", "2001", 2.93, 1.60,
  "age", "2001", 44, 18.33,
  "income", "2001", 4.99, 3.36,
  "male", "2001", 0.50, 0.50,
  "party_contact", "2001", 0.08, 0.27,
  "pol_efficacy", "2001", 1.84, 2.19,
  "pol_interest", "2001", 1.89, 1.07,
  "internet_info", "2001", 0.17, 0.48,
  "vote", "2001", 0.69, 0.46,
  "work_party", "2001", 1.25, 2.33,
  "donate", "2001", 1.19, 2.39,
  "discuss", "2001", 5.07, 3.55,
  "education", "2005", 2.79, 1.59,
  "age", "2005", 47, 18,
  "income", "2005", 6.04, 3.45,
  "male", "2005", 0.48, 0.50,
  "party_contact", "2005", 0.06, 0.23,
  "pol_efficacy", "2005", 2.71, 2.28,
  "pol_interest", "2005", 2.07, 0.98,
  "internet_info", "2005", 0.23, 0.64,
  "vote", "2005", 0.72, 0.45,
  "work_party", "2005", 1.24, 2.09,
  "donate", "2005", 1.34, 2.21,
  "discuss", "2005", 5.42, 3.36,
  "education", "2010", 3.12, 1.57,
  "age", "2010", 47, 18,
  "income", "2010", 6.92, 4.03,
  "male", "2010", 0.47, 0.50,
  "party_contact", "2010", 0.53, 0.50,
  "pol_efficacy", "2010", 1.84, 2.22,
  "pol_interest", "2010", 2.16, 1.07,
  "internet_info", "2010", 0.54, 0.85,
  "vote", "2010", 0.77, 0.42,
  "work_party", "2010", 1.28, 2.21,
  "donate", "2010", 1.05, 2.07,
  "discuss", "2010", 5.62, 3.36
)

# Merge and display comparison
desc_compare <- desc_all %>%
  left_join(paper_desc, by = c("Variable", "Year")) %>%
  filter(!is.na(Paper_Mean)) %>%
  mutate(
    Mean_diff = Mean - Paper_Mean,
    Variable = factor(Variable, levels = c("education", "age", "income", "male",
                                            "party_contact", "pol_efficacy",
                                            "pol_interest", "internet_info",
                                            "vote", "work_party", "donate", "discuss"))
  ) %>%
  arrange(Year, Variable)

desc_display <- desc_compare %>%
  dplyr::select(Year, Variable, Paper_Mean, Mean, Mean_diff, Paper_SD, SD, N)

desc_display %>%
  kable(caption = "Descriptive Statistics Comparison with Table 1",
        digits = 2,
        col.names = c("Year", "Variable", "Paper Mean", "Reproduced Mean",
                       "Difference", "Paper SD", "Reproduced SD", "N")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(5, background = ifelse(abs(desc_display$Mean_diff) > 0.5, "#f8d7da", "#d4edda"))
```

---

## Reproduction Results

### Table 2: Logistic Regression — Voting

```{r table2-voting}
#| label: table2-voting

# Fit logistic regression models for voting
fit_voting_models <- function(d, w) {
  # Main effects model
  main <- glm(vote ~ education + age + income + male + party_contact +
                pol_efficacy + pol_interest + internet_info,
              data = d, family = binomial(link = "logit"), weights = w)

  # Interaction model
  inter <- glm(vote ~ education + age + income + male + party_contact +
                 pol_efficacy + pol_interest + internet_info +
                 internet_info:pol_interest,
               data = d, family = binomial(link = "logit"), weights = w)

  list(main = main, inter = inter)
}

voting_models <- map(names(datasets), function(yr) {
  d <- datasets[[yr]] %>% drop_na(vote, education, age, income, male,
                                    party_contact, pol_efficacy, pol_interest,
                                    internet_info)
  fit_voting_models(d, d$weight)
}) %>% set_names(names(datasets))

# Extract odds ratios and SEs
extract_logit_results <- function(model) {
  s <- summary(model)
  coefs <- s$coefficients
  or <- exp(coefs[, "Estimate"])
  # SE of OR using delta method: SE(OR) = OR * SE(log-OR)
  se_or <- or * coefs[, "Std. Error"]
  tibble(
    term = rownames(coefs),
    OR = or,
    SE = se_or,
    p = coefs[, "Pr(>|z|)"]
  )
}

# Build comparison table for Table 2
voting_results <- map_dfr(names(voting_models), function(yr) {
  main_res <- extract_logit_results(voting_models[[yr]]$main) %>%
    mutate(Year = yr, Model = "Main Effect")
  inter_res <- extract_logit_results(voting_models[[yr]]$inter) %>%
    mutate(Year = yr, Model = "Interaction")
  bind_rows(main_res, inter_res)
})

# Add model fit statistics
voting_fit <- map_dfr(names(voting_models), function(yr) {
  for (type in c("main", "inter")) {
    m <- voting_models[[yr]][[type]]
    null_dev <- m$null.deviance
    resid_dev <- m$deviance
    lr_chi2 <- null_dev - resid_dev
    df_lr <- m$df.null - m$df.residual
    pseudo_r2 <- 1 - resid_dev / null_dev
    n <- nrow(m$model)
  }
  # Return for both models
  bind_rows(
    tibble(Year = yr, Model = "Main Effect",
           N = nrow(voting_models[[yr]]$main$model),
           LR_chi2 = voting_models[[yr]]$main$null.deviance - voting_models[[yr]]$main$deviance,
           df = voting_models[[yr]]$main$df.null - voting_models[[yr]]$main$df.residual,
           Pseudo_R2 = 1 - voting_models[[yr]]$main$deviance / voting_models[[yr]]$main$null.deviance),
    tibble(Year = yr, Model = "Interaction",
           N = nrow(voting_models[[yr]]$inter$model),
           LR_chi2 = voting_models[[yr]]$inter$null.deviance - voting_models[[yr]]$inter$deviance,
           df = voting_models[[yr]]$inter$df.null - voting_models[[yr]]$inter$df.residual,
           Pseudo_R2 = 1 - voting_models[[yr]]$inter$deviance / voting_models[[yr]]$inter$null.deviance)
  )
})

# Display results in a formatted table
format_coef <- function(or, se, p) {
  stars <- case_when(
    p < 0.001 ~ "***",
    p < 0.01 ~ "**",
    p < 0.05 ~ "*",
    TRUE ~ ""
  )
  paste0(sprintf("%.3f%s", or, stars), "\n(", sprintf("%.3f", se), ")")
}

# Create wide-format table matching paper's Table 2
var_order <- c("(Intercept)", "education", "age", "income", "male",
               "party_contact", "pol_efficacy", "pol_interest",
               "internet_info", "pol_interest:internet_info")
var_labels <- c("Constant", "Education", "Age", "Income", "Male",
                "Party contact", "Political efficacy", "Political interest",
                "Internet info", "Interaction")

voting_wide <- voting_results %>%
  mutate(
    display = paste0(sprintf("%.3f", OR),
                     case_when(p < 0.001 ~ "***", p < 0.01 ~ "**",
                               p < 0.05 ~ "*", TRUE ~ ""),
                     "<br>(", sprintf("%.3f", SE), ")")
  ) %>%
  mutate(col = paste(Model, Year)) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display) %>%
  mutate(term = factor(term, levels = var_order, labels = var_labels)) %>%
  filter(!is.na(term)) %>%
  arrange(term)

# Also add fit stats rows
fit_rows <- voting_fit %>%
  mutate(col = paste(Model, Year)) %>%
  pivot_longer(cols = c(N, LR_chi2, Pseudo_R2), names_to = "term", values_to = "value") %>%
  mutate(
    display = case_when(
      term == "N" ~ format(round(value), big.mark = ","),
      term == "LR_chi2" ~ sprintf("%.2f***", value),
      term == "Pseudo_R2" ~ sprintf("%.3f", value)
    ),
    term = case_when(
      term == "N" ~ "Observations",
      term == "LR_chi2" ~ "LR χ²(9)",
      term == "Pseudo_R2" ~ "Pseudo R²"
    )
  ) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display)

bind_rows(voting_wide, fit_rows) %>%
  kable(format = "html", escape = FALSE,
        caption = "Table 2 Reproduction: Logistic Regression Models Predicting Voting",
        col.names = c("", "2001", "2005", "2010", "2001", "2005", "2010")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  add_header_above(c(" " = 1, "Main Effect" = 3, "Interaction" = 3))
```


### Table 3: OLS Regression — Donating Money

```{r table3-donating}
#| label: table3-donating

# Fit OLS models for donating
fit_ols_models <- function(d, w, dv) {
  formula_main <- as.formula(paste(dv, "~ education + age + income + male + party_contact +
                                    pol_efficacy + pol_interest + internet_info"))
  formula_inter <- as.formula(paste(dv, "~ education + age + income + male + party_contact +
                                     pol_efficacy + pol_interest + internet_info +
                                     internet_info:pol_interest"))

  main <- lm(formula_main, data = d, weights = w)
  inter <- lm(formula_inter, data = d, weights = w)

  list(main = main, inter = inter)
}

donate_models <- map(names(datasets), function(yr) {
  d <- datasets[[yr]] %>% drop_na(donate, education, age, income, male,
                                    party_contact, pol_efficacy, pol_interest,
                                    internet_info)
  fit_ols_models(d, d$weight, "donate")
}) %>% set_names(names(datasets))

# Extract coefficients
extract_ols_results <- function(model) {
  s <- summary(model)
  coefs <- s$coefficients
  tibble(
    term = rownames(coefs),
    Coef = coefs[, "Estimate"],
    SE = coefs[, "Std. Error"],
    p = coefs[, "Pr(>|t|)"]
  )
}

donate_results <- map_dfr(names(donate_models), function(yr) {
  main_res <- extract_ols_results(donate_models[[yr]]$main) %>%
    mutate(Year = yr, Model = "Main Effects")
  inter_res <- extract_ols_results(donate_models[[yr]]$inter) %>%
    mutate(Year = yr, Model = "Interactions")
  bind_rows(main_res, inter_res)
})

# Fit stats
donate_fit <- map_dfr(names(donate_models), function(yr) {
  bind_rows(
    tibble(Year = yr, Model = "Main Effects",
           N = nrow(donate_models[[yr]]$main$model),
           R2 = summary(donate_models[[yr]]$main)$r.squared,
           Adj_R2 = summary(donate_models[[yr]]$main)$adj.r.squared),
    tibble(Year = yr, Model = "Interactions",
           N = nrow(donate_models[[yr]]$inter$model),
           R2 = summary(donate_models[[yr]]$inter)$r.squared,
           Adj_R2 = summary(donate_models[[yr]]$inter)$adj.r.squared)
  )
})

# Format table
donate_wide <- donate_results %>%
  mutate(
    display = paste0(sprintf("%.3f", Coef),
                     case_when(p < 0.001 ~ "***", p < 0.01 ~ "**",
                               p < 0.05 ~ "*", TRUE ~ ""),
                     "<br>(", sprintf("%.3f", SE), ")")
  ) %>%
  mutate(col = paste(Model, Year)) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display) %>%
  mutate(term = factor(term, levels = var_order, labels = var_labels)) %>%
  filter(!is.na(term)) %>%
  arrange(term)

fit_rows_d <- donate_fit %>%
  mutate(col = paste(Model, Year)) %>%
  pivot_longer(cols = c(N, R2, Adj_R2), names_to = "term", values_to = "value") %>%
  mutate(
    display = case_when(
      term == "N" ~ format(round(value), big.mark = ","),
      TRUE ~ sprintf("%.3f", value)
    ),
    term = case_when(
      term == "N" ~ "Observations",
      term == "R2" ~ "R²",
      term == "Adj_R2" ~ "Adjusted R²"
    )
  ) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display)

bind_rows(donate_wide, fit_rows_d) %>%
  kable(format = "html", escape = FALSE,
        caption = "Table 3 Reproduction: OLS Regression Models Predicting Donating",
        col.names = c("", "2001", "2005", "2010", "2001", "2005", "2010")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  add_header_above(c(" " = 1, "Main Effects" = 3, "Interactions" = 3))
```


### Table 4: Negative Binomial Regression — Working for a Party

```{r table4-workparty}
#| label: table4-workparty

# Fit negative binomial models for working for a party
# Store data alongside models so update() can find it
work_data <- map(names(datasets), function(yr) {
  datasets[[yr]] %>% drop_na(work_party, education, age, income, male,
                               party_contact, pol_efficacy, pol_interest,
                               internet_info)
}) %>% set_names(names(datasets))

work_models <- map(names(datasets), function(yr) {
  d <- work_data[[yr]]
  main <- MASS::glm.nb(work_party ~ education + age + income + male + party_contact +
                          pol_efficacy + pol_interest + internet_info,
                        data = d, weights = d$weight)

  inter <- MASS::glm.nb(work_party ~ education + age + income + male + party_contact +
                           pol_efficacy + pol_interest + internet_info +
                           internet_info:pol_interest,
                         data = d, weights = d$weight)

  list(main = main, inter = inter)
}) %>% set_names(names(datasets))

# Extract NB coefficients (reported as coefficients, not IRRs)
extract_nb_results <- function(model) {
  s <- summary(model)
  coefs <- s$coefficients
  tibble(
    term = rownames(coefs),
    Coef = coefs[, "Estimate"],
    SE = coefs[, "Std. Error"],
    p = coefs[, "Pr(>|z|)"]
  )
}

work_results <- map_dfr(names(work_models), function(yr) {
  main_res <- extract_nb_results(work_models[[yr]]$main) %>%
    mutate(Year = yr, Model = "Main Effects")
  inter_res <- extract_nb_results(work_models[[yr]]$inter) %>%
    mutate(Year = yr, Model = "Interactions")
  bind_rows(main_res, inter_res)
})

# Fit statistics for NB models
# Compute null model separately to avoid scope issues with update()
compute_nb_fit <- function(m, yr, model_label, d) {
  n <- nrow(m$model)
  null_m <- MASS::glm.nb(work_party ~ 1, data = d, weights = d$weight)
  ll_null <- logLik(null_m)
  ll_full <- logLik(m)
  cox_snell <- 1 - exp(2 * (as.numeric(ll_null) - as.numeric(ll_full)) / n)
  max_cox_snell <- 1 - exp(2 * as.numeric(ll_null) / n)
  nagelkerke_r2 <- cox_snell / max_cox_snell
  chi2 <- -2 * (as.numeric(ll_null) - as.numeric(ll_full))
  tibble(Year = yr, Model = model_label, N = n,
         Nagelkerke_R2 = nagelkerke_r2, alpha = m$theta, chi2 = chi2)
}

work_fit <- map_dfr(names(work_models), function(yr) {
  d <- work_data[[yr]]
  bind_rows(
    compute_nb_fit(work_models[[yr]]$main, yr, "Main Effects", d),
    compute_nb_fit(work_models[[yr]]$inter, yr, "Interactions", d)
  )
})

# Format table
work_wide <- work_results %>%
  mutate(
    display = paste0(sprintf("%.3f", Coef),
                     case_when(p < 0.001 ~ "***", p < 0.01 ~ "**",
                               p < 0.05 ~ "*", TRUE ~ ""),
                     "<br>(", sprintf("%.3f", SE), ")")
  ) %>%
  mutate(col = paste(Model, Year)) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display) %>%
  mutate(term = factor(term, levels = var_order, labels = var_labels)) %>%
  filter(!is.na(term)) %>%
  arrange(term)

fit_rows_w <- work_fit %>%
  mutate(col = paste(Model, Year)) %>%
  pivot_longer(cols = c(N, Nagelkerke_R2, alpha, chi2), names_to = "term", values_to = "value") %>%
  mutate(
    display = case_when(
      term == "N" ~ format(round(value), big.mark = ","),
      term == "alpha" ~ sprintf("%.1f", value),
      term == "chi2" ~ sprintf("%.2f", value),
      TRUE ~ sprintf("%.2f", value)
    ),
    term = case_when(
      term == "N" ~ "Observations",
      term == "Nagelkerke_R2" ~ "Nagelkerke R²",
      term == "alpha" ~ "α",
      term == "chi2" ~ "χ²"
    )
  ) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display)

bind_rows(work_wide, fit_rows_w) %>%
  kable(format = "html", escape = FALSE,
        caption = "Table 4 Reproduction: Negative Binomial Models Predicting Working for a Party",
        col.names = c("", "2001", "2005", "2010", "2001", "2005", "2010")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  add_header_above(c(" " = 1, "Main Effects" = 3, "Interactions" = 3))
```


### Table 5: OLS Regression — Discussing Politics

```{r table5-discuss}
#| label: table5-discuss

discuss_models <- map(names(datasets), function(yr) {
  d <- datasets[[yr]] %>% drop_na(discuss, education, age, income, male,
                                    party_contact, pol_efficacy, pol_interest,
                                    internet_info)
  fit_ols_models(d, d$weight, "discuss")
}) %>% set_names(names(datasets))

discuss_results <- map_dfr(names(discuss_models), function(yr) {
  main_res <- extract_ols_results(discuss_models[[yr]]$main) %>%
    mutate(Year = yr, Model = "Main Effects")
  inter_res <- extract_ols_results(discuss_models[[yr]]$inter) %>%
    mutate(Year = yr, Model = "Interactions")
  bind_rows(main_res, inter_res)
})

# Fit stats
discuss_fit <- map_dfr(names(discuss_models), function(yr) {
  bind_rows(
    tibble(Year = yr, Model = "Main Effects",
           N = nrow(discuss_models[[yr]]$main$model),
           R2 = summary(discuss_models[[yr]]$main)$r.squared,
           Adj_R2 = summary(discuss_models[[yr]]$main)$adj.r.squared),
    tibble(Year = yr, Model = "Interactions",
           N = nrow(discuss_models[[yr]]$inter$model),
           R2 = summary(discuss_models[[yr]]$inter)$r.squared,
           Adj_R2 = summary(discuss_models[[yr]]$inter)$adj.r.squared)
  )
})

# Format table
discuss_wide <- discuss_results %>%
  mutate(
    display = paste0(sprintf("%.3f", Coef),
                     case_when(p < 0.001 ~ "***", p < 0.01 ~ "**",
                               p < 0.05 ~ "*", TRUE ~ ""),
                     "<br>(", sprintf("%.3f", SE), ")")
  ) %>%
  mutate(col = paste(Model, Year)) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display) %>%
  mutate(term = factor(term, levels = var_order, labels = var_labels)) %>%
  filter(!is.na(term)) %>%
  arrange(term)

fit_rows_disc <- discuss_fit %>%
  mutate(col = paste(Model, Year)) %>%
  pivot_longer(cols = c(N, R2, Adj_R2), names_to = "term", values_to = "value") %>%
  mutate(
    display = case_when(
      term == "N" ~ format(round(value), big.mark = ","),
      TRUE ~ sprintf("%.3f", value)
    ),
    term = case_when(
      term == "N" ~ "Observations",
      term == "R2" ~ "R²",
      term == "Adj_R2" ~ "Adjusted R²"
    )
  ) %>%
  select(term, col, display) %>%
  pivot_wider(names_from = col, values_from = display)

bind_rows(discuss_wide, fit_rows_disc) %>%
  kable(format = "html", escape = FALSE,
        caption = "Table 5 Reproduction: OLS Regression Models Predicting Discussing Politics",
        col.names = c("", "2001", "2005", "2010", "2001", "2005", "2010")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  add_header_above(c(" " = 1, "Main Effects" = 3, "Interactions" = 3))
```


---

## Deviation Log

```{r deviation-log}
#| label: deviation-log

# Build deviation log programmatically from model results
# Focus on claim-relevant parameters

# Paper values for key parameters (from Tables 2-5)
paper_values <- tribble(
  ~Claim, ~Table, ~Model, ~Year, ~Parameter, ~Paper, ~Paper_sig, ~is_ratio_scale,

  # Claim 2: Voting (Table 2) - odds ratios
  2, "Table 2", "Main Effect", "2001", "Internet info (OR)", 1.154, FALSE, TRUE,
  2, "Table 2", "Main Effect", "2005", "Internet info (OR)", 1.274, TRUE, TRUE,
  2, "Table 2", "Main Effect", "2010", "Internet info (OR)", 1.754, TRUE, TRUE,
  2, "Table 2", "Interaction", "2001", "Internet info (OR)", 1.151, FALSE, TRUE,
  2, "Table 2", "Interaction", "2005", "Internet info (OR)", 1.043, FALSE, TRUE,
  2, "Table 2", "Interaction", "2010", "Internet info (OR)", 2.107, TRUE, TRUE,
  2, "Table 2", "Interaction", "2001", "Interaction (OR)", 1.234, FALSE, TRUE,
  2, "Table 2", "Interaction", "2005", "Interaction (OR)", 1.043, FALSE, TRUE,
  2, "Table 2", "Interaction", "2010", "Interaction (OR)", 0.917, FALSE, TRUE,
  2, "Table 2", "Main Effect", "2001", "N", 1463, NA, FALSE,
  2, "Table 2", "Main Effect", "2005", "N", 3594, NA, FALSE,
  2, "Table 2", "Main Effect", "2010", "N", 2357, NA, FALSE,
  2, "Table 2", "Main Effect", "2001", "Pseudo R²", 0.14, NA, FALSE,
  2, "Table 2", "Main Effect", "2005", "Pseudo R²", 0.18, NA, FALSE,
  2, "Table 2", "Main Effect", "2010", "Pseudo R²", 0.202, NA, FALSE,

  # Claim 3: Donating (Table 3)
  3, "Table 3", "Main Effects", "2001", "Internet info", 0.310, TRUE, FALSE,
  3, "Table 3", "Main Effects", "2005", "Internet info", 0.287, TRUE, FALSE,
  3, "Table 3", "Main Effects", "2010", "Internet info", 0.073, FALSE, FALSE,
  3, "Table 3", "Interactions", "2001", "Internet info", 1.427, TRUE, FALSE,
  3, "Table 3", "Interactions", "2005", "Internet info", -0.109, FALSE, FALSE,
  3, "Table 3", "Interactions", "2010", "Internet info", -0.050, FALSE, FALSE,
  3, "Table 3", "Interactions", "2001", "Interaction", -0.460, TRUE, FALSE,
  3, "Table 3", "Interactions", "2005", "Interaction", 0.144, TRUE, FALSE,
  3, "Table 3", "Interactions", "2010", "Interaction", 0.048, FALSE, FALSE,
  3, "Table 3", "Main Effects", "2001", "N", 1478, NA, FALSE,
  3, "Table 3", "Main Effects", "2005", "N", 3514, NA, FALSE,
  3, "Table 3", "Main Effects", "2010", "N", 2308, NA, FALSE,
  3, "Table 3", "Main Effects", "2001", "R²", 0.118, NA, FALSE,
  3, "Table 3", "Main Effects", "2005", "R²", 0.121, NA, FALSE,
  3, "Table 3", "Main Effects", "2010", "R²", 0.105, NA, FALSE,

  # Claim 3: Working for Party (Table 4)
  3, "Table 4", "Main Effects", "2001", "Internet info", 0.118, FALSE, FALSE,
  3, "Table 4", "Main Effects", "2005", "Internet info", 0.201, TRUE, FALSE,
  3, "Table 4", "Main Effects", "2010", "Internet info", 0.084, FALSE, FALSE,
  3, "Table 4", "Interactions", "2001", "Internet info", 0.262, FALSE, FALSE,
  3, "Table 4", "Interactions", "2005", "Internet info", -0.022, FALSE, FALSE,
  3, "Table 4", "Interactions", "2010", "Internet info", 0.328, TRUE, FALSE,
  3, "Table 4", "Interactions", "2001", "Interaction", -0.202, FALSE, FALSE,
  3, "Table 4", "Interactions", "2005", "Interaction", -0.022, FALSE, FALSE,
  3, "Table 4", "Interactions", "2010", "Interaction", -0.092, TRUE, FALSE,
  3, "Table 4", "Main Effects", "2001", "N", 1462, NA, FALSE,
  3, "Table 4", "Main Effects", "2005", "N", 3595, NA, FALSE,
  3, "Table 4", "Main Effects", "2010", "N", 2354, NA, FALSE,
  3, "Table 4", "Main Effects", "2001", "Nagelkerke R²", 0.08, NA, FALSE,
  3, "Table 4", "Main Effects", "2005", "Nagelkerke R²", 0.12, NA, FALSE,
  3, "Table 4", "Main Effects", "2010", "Nagelkerke R²", 0.14, NA, FALSE,

  # Claim 1: Discussing Politics (Table 5)
  1, "Table 5", "Main Effects", "2001", "Internet info", 0.573, TRUE, FALSE,
  1, "Table 5", "Main Effects", "2005", "Internet info", 0.291, TRUE, FALSE,
  1, "Table 5", "Main Effects", "2010", "Internet info", 0.468, TRUE, FALSE,
  1, "Table 5", "Interactions", "2001", "Internet info", 2.007, TRUE, FALSE,
  1, "Table 5", "Interactions", "2005", "Internet info", 1.009, TRUE, FALSE,
  1, "Table 5", "Interactions", "2010", "Internet info", 1.010, TRUE, FALSE,
  1, "Table 5", "Interactions", "2001", "Interaction", -0.590, TRUE, FALSE,
  1, "Table 5", "Interactions", "2005", "Interaction", -0.260, TRUE, FALSE,
  1, "Table 5", "Interactions", "2010", "Interaction", -0.209, TRUE, FALSE,
  1, "Table 5", "Main Effects", "2001", "N", 1479, NA, FALSE,
  1, "Table 5", "Main Effects", "2005", "N", 3514, NA, FALSE,
  1, "Table 5", "Main Effects", "2010", "N", 2313, NA, FALSE,
  1, "Table 5", "Main Effects", "2001", "R²", 0.274, NA, FALSE,
  1, "Table 5", "Main Effects", "2005", "R²", 0.369, NA, FALSE,
  1, "Table 5", "Main Effects", "2010", "R²", 0.387, NA, FALSE
)

# Now compute reproduced values from model objects
get_reproduced_value <- function(table, model_type, year, parameter) {
  if (table == "Table 2") {
    m <- voting_models[[year]][[ifelse(model_type == "Main Effect", "main", "inter")]]
    if (parameter == "N") return(nrow(m$model))
    if (parameter == "Pseudo R²") return(1 - m$deviance / m$null.deviance)
    # R names interaction term alphabetically: pol_interest:internet_info
    inter_term <- "pol_interest:internet_info"
    term <- case_when(
      parameter == "Internet info (OR)" ~ "internet_info",
      parameter == "Interaction (OR)" ~ inter_term,
      TRUE ~ NA_character_
    )
    if (is.na(term)) return(NA_real_)
    coefs <- coef(m)
    if (!term %in% names(coefs)) return(NA_real_)
    return(exp(coefs[term]))
  }

  if (table == "Table 3") {
    m <- donate_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
    if (parameter == "N") return(nrow(m$model))
    if (parameter == "R²") return(summary(m)$r.squared)
    inter_term <- "pol_interest:internet_info"
    term <- case_when(
      parameter == "Internet info" ~ "internet_info",
      parameter == "Interaction" ~ inter_term,
      TRUE ~ NA_character_
    )
    if (is.na(term)) return(NA_real_)
    coefs <- coef(m)
    if (!term %in% names(coefs)) return(NA_real_)
    return(coefs[term])
  }

  if (table == "Table 4") {
    m <- work_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
    if (parameter == "N") return(nrow(m$model))
    if (parameter == "Nagelkerke R²") {
      d <- work_data[[year]]
      n <- nrow(m$model)
      null_m <- MASS::glm.nb(work_party ~ 1, data = d, weights = d$weight)
      ll_null <- logLik(null_m)
      ll_full <- logLik(m)
      cox_snell <- 1 - exp(2 * (as.numeric(ll_null) - as.numeric(ll_full)) / n)
      max_cox_snell <- 1 - exp(2 * as.numeric(ll_null) / n)
      return(cox_snell / max_cox_snell)
    }
    inter_term <- "pol_interest:internet_info"
    term <- case_when(
      parameter == "Internet info" ~ "internet_info",
      parameter == "Interaction" ~ inter_term,
      TRUE ~ NA_character_
    )
    if (is.na(term)) return(NA_real_)
    coefs <- coef(m)
    if (!term %in% names(coefs)) return(NA_real_)
    return(coefs[term])
  }

  if (table == "Table 5") {
    m <- discuss_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
    if (parameter == "N") return(nrow(m$model))
    if (parameter == "R²") return(summary(m)$r.squared)
    inter_term <- "pol_interest:internet_info"
    term <- case_when(
      parameter == "Internet info" ~ "internet_info",
      parameter == "Interaction" ~ inter_term,
      TRUE ~ NA_character_
    )
    if (is.na(term)) return(NA_real_)
    coefs <- coef(m)
    if (!term %in% names(coefs)) return(NA_real_)
    return(coefs[term])
  }

  NA_real_
}

# Get reproduced significance
get_reproduced_sig <- function(table, model_type, year, parameter) {
  if (parameter %in% c("N", "R²", "Pseudo R²", "Nagelkerke R²")) return(NA_character_)

  inter_term <- "pol_interest:internet_info"
  term <- case_when(
    parameter %in% c("Internet info (OR)", "Internet info") ~ "internet_info",
    parameter %in% c("Interaction (OR)", "Interaction") ~ inter_term,
    TRUE ~ NA_character_
  )
  if (is.na(term)) return(NA_character_)

  if (table == "Table 2") {
    m <- voting_models[[year]][[ifelse(model_type == "Main Effect", "main", "inter")]]
  } else if (table == "Table 3") {
    m <- donate_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
  } else if (table == "Table 4") {
    m <- work_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
  } else if (table == "Table 5") {
    m <- discuss_models[[year]][[ifelse(model_type == "Main Effects", "main", "inter")]]
  }

  s <- summary(m)$coefficients
  if (!term %in% rownames(s)) return(NA_character_)
  p <- s[term, ncol(s)]

  case_when(
    p < 0.001 ~ "***",
    p < 0.01 ~ "**",
    p < 0.05 ~ "*",
    TRUE ~ "n.s."
  )
}

# Build the deviation log
deviations <- paper_values %>%
  rowwise() %>%
  mutate(
    Reproduced = get_reproduced_value(Table, Model, Year, Parameter),
    Reproduced_sig = get_reproduced_sig(Table, Model, Year, Parameter)
  ) %>%
  ungroup() %>%
  filter(!is.na(Reproduced)) %>%
  mutate(
    # For parameters that are clearly significant in paper
    paper_sig_flag = case_when(
      !is.na(Paper_sig) & Paper_sig == TRUE ~ TRUE,
      !is.na(Paper_sig) & Paper_sig == FALSE ~ FALSE,
      TRUE ~ NA
    )
  ) %>%
  rowwise() %>%
  mutate(
    assessment = list(classify_deviation(Paper, Reproduced, significant = paper_sig_flag))
  ) %>%
  unnest(assessment) %>%
  ungroup()

# Check for conclusion changes: significance or direction differs
deviations <- deviations %>%
  mutate(
    # Paper significance from stars
    paper_sig_str = case_when(
      is.na(Paper_sig) ~ NA_character_,
      Paper_sig == TRUE ~ "sig",
      Paper_sig == FALSE ~ "n.s."
    ),
    repro_sig_str = case_when(
      is.na(Reproduced_sig) ~ NA_character_,
      Reproduced_sig %in% c("*", "**", "***") ~ "sig",
      TRUE ~ "n.s."
    ),
    sig_differs = !is.na(paper_sig_str) & !is.na(repro_sig_str) & paper_sig_str != repro_sig_str,
    direction_differs = case_when(
      is_ratio_scale ~ (Paper > 1 & Reproduced < 1) | (Paper < 1 & Reproduced > 1),
      Parameter %in% c("N", "R²", "Pseudo R²", "Nagelkerke R²") ~ FALSE,
      TRUE ~ sign(Paper) != sign(Reproduced) & abs(Paper) > 0.01
    ),
    category = if_else(
      sig_differs | direction_differs,
      "Conclusion change",
      category
    )
  )

# Display deviation log
deviations %>%
  select(Claim, Table, `Model/Year` = Model, Year, Parameter,
         Paper, Reproduced, Reproduced_sig, abs_deviation, rel_deviation_pct, category) %>%
  arrange(Claim, Table, Year) %>%
  kable(
    caption = "Complete Deviation Log (organized by claim)",
    col.names = c("Claim", "Table", "Model", "Year", "Parameter", "Paper",
                   "Reproduced", "Sig.", "Abs. Dev.", "Rel. Dev. (%)", "Category"),
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 11) %>%
  column_spec(
    11,
    background = case_when(
      deviations %>% arrange(Claim, Table, Year) %>% pull(category) == "Exact" ~ "#d4edda",
      deviations %>% arrange(Claim, Table, Year) %>% pull(category) == "Minor deviation" ~ "#fff3cd",
      deviations %>% arrange(Claim, Table, Year) %>% pull(category) == "Substantive deviation" ~ "#f8d7da",
      deviations %>% arrange(Claim, Table, Year) %>% pull(category) == "Conclusion change" ~ "#f5c6cb",
      TRUE ~ "#ffffff"
    )
  )

# Coverage summary
coverage <- deviations %>%
  group_by(Claim) %>%
  summarise(
    n_entries = n(),
    tables_covered = paste(unique(Table), collapse = ", "),
    .groups = "drop"
  )

coverage %>%
  kable(caption = "Deviation Log Coverage by Claim",
        col.names = c("Claim", "N Entries", "Tables Covered")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)

# Summary of deviation categories
deviations %>%
  count(category) %>%
  kable(caption = "Deviation Category Summary",
        col.names = c("Category", "Count")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

Significance was computed using Wald z-tests for logistic and negative binomial models, and t-tests for OLS models (standard R output). The paper uses *p < .05, **p < .01, ***p < .001.

---

## Discrepancy Investigation

```{r discrepancy}
#| label: discrepancy

# Identify substantive deviations and conclusion changes
issues <- deviations %>%
  filter(category %in% c("Substantive deviation", "Conclusion change"))

if (nrow(issues) > 0) {
  issues %>%
    select(Claim, Table, Year, Parameter, Paper, Reproduced, category) %>%
    kable(caption = "Parameters Requiring Investigation",
          digits = 3) %>%
    kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
}
```

### Pattern of deviations

Deviations are strongly concentrated in the earlier data: all 8 conclusion changes involve 2001 parameters (6 entries) or 2005 parameters (2 entries), with none in 2010. In contrast, 2010 results are very closely reproduced across all four dependent variables, with many exact matches. This pattern suggests that the source of discrepancies is not a systematic methodological error but rather something specific to how the 2001 (and to a lesser extent 2005) data were processed — possibly the weight variable or the internet use variable construction.

### Possible explanations

1. **Weight variable selection**: The paper states only that "We weighted all analyses in accordance with BES specifications to reflect general population parameters" without specifying which weight variable was used. For the 2001 data, we used `MAILWGT` (mailback weight) because the internet use variable (`CQ6`) comes from the mailback questionnaire, but the paper may have used a different weight (e.g., the face-to-face interview weight). Different weights could substantially affect coefficients, particularly for internet-related variables where the mailback subsample may differ systematically from the full sample.

2. **Internet use coding for non-users**: The paper does not explicitly describe how non-internet users were coded on the internet information variable. We coded non-internet users as 0 (no use), which is a common approach. However, the paper may have treated them differently (e.g., as missing), which would change the effective sample and the distribution of the internet information variable.

3. **Sample composition differences**: The reproduced sample sizes are close but not identical to the paper's (e.g., 2001 voting: paper N=1,463, reproduced N=1,476; 2005 discussing: paper N=3,514, reproduced N=3,594). These differences indicate slightly different case inclusion/exclusion criteria, possibly due to different handling of missing values, different variable selections, or different treatment of edge cases in variable recoding.

4. **Software differences**: The paper does not specify which statistical software was used. Different implementations of weighted regression (particularly negative binomial regression with weights) can produce different results. The 2001 negative binomial models (Table 4) show some of the largest deviations, which is consistent with software-related differences in how observation-level weights are handled in NB models.

5. **Party contact variable (2001)**: In 2001, the paper notes that the party contact question was "Were you telephoned by a Canvasser?" (footnote 2). We used `BQ62` ("Knocked up by party"), which may not be the exact variable the authors used, though the descriptive statistics are reasonably close.

---

## Conclusion

```{r conclusion}
#| label: conclusion

# Programmatic summary
n_exact <- sum(deviations$category == "Exact")
n_minor <- sum(deviations$category == "Minor deviation")
n_substantive <- sum(deviations$category == "Substantive deviation")
n_conclusion <- sum(deviations$category == "Conclusion change")
n_total <- nrow(deviations)

# Check claim coverage
claims_covered <- deviations %>%
  group_by(Claim) %>%
  summarise(
    n = n(),
    has_conclusion_change = any(category == "Conclusion change"),
    .groups = "drop"
  )
```

**Reproduction status: PARTIALLY REPRODUCED**

Out of `r n_total` parameters tested, `r n_exact` were classified as Exact, `r n_minor` as Minor deviation, `r n_substantive` as Substantive deviation, and `r n_conclusion` as Conclusion change. The deviations are concentrated in the 2001 data, with 2010 results closely matching the paper across all dependent variables. No replication materials were available for this paper, so the reproduction relied entirely on the paper's description and the raw BES data. Possible sources of discrepancy include the choice of weight variable (unspecified in the paper) and the coding of internet use for non-internet users, both of which would disproportionately affect the 2001 mailback questionnaire subsample.

### Claim-by-Claim Assessment

1. **Claim 1** (Digital media positively and consistently associated with political talk for low-interest citizens): **Reproduced.** The key interaction terms in Table 5 (Internet info x Political interest) are negative and statistically significant in all three years in both the paper and our reproduction (2001: paper -0.590*** vs. reproduced -0.414*, same direction and significance; 2005: -0.260*** vs. -0.341***, same; 2010: -0.209*** vs. -0.208***, essentially exact). The negative interactions confirm that internet information use is associated with more political discussion especially for those lower in political interest. While the magnitudes show substantive deviations in 2001 and 2005, the qualitative pattern — consistent negative moderation across all three years — is fully confirmed.

2. **Claim 2** (Voting relationship strengthening over time): **Reproduced.** The Internet info odds ratio in the main effect model grows from 1.559 (2001) to 1.240 (2005) to 1.757 (2010) in our reproduction, compared to 1.154 to 1.274 to 1.754 in the paper. While the 2001 value shows a conclusion change (becoming statistically significant in our reproduction, paper reports n.s.), this actually strengthens the paper's claim about a positive relationship. The 2010 interaction model OR (2.108 vs. paper 2.107) and interaction term OR (0.918 vs. paper 0.917) are essentially exact matches. The strengthening-over-time pattern and the non-significant interaction terms (indicating the relationship holds across interest levels for voting) are reproduced.

3. **Claim 3** (Variable moderating effect for elite-directed acts): **Partially reproduced.** The claim that the moderating effect is "highly variable" and "can be positive, negative, or nonexistent" is partially supported. For **donating** (Table 3): the 2010 interaction (0.047 n.s., paper 0.048 n.s.) is exactly reproduced; however, the 2001 interaction loses significance (-0.261 n.s. vs. paper -0.460***) and the 2005 interaction also loses significance (0.121 n.s. vs. paper 0.144*), representing conclusion changes. For **working for party** (Table 4): the 2010 interaction (-0.092*, paper -0.092*) is exactly reproduced; the 2005 interaction (-0.055 n.s., paper -0.022 n.s.) matches in conclusion; but the 2001 interaction becomes strongly significant (-0.386*** vs. paper -0.202 n.s.), a conclusion change. The overall variability pattern is present, but the specific configuration of significant/non-significant interactions across years differs from the paper, particularly for 2001.

---

## Session Info

```{r session-info}
#| label: session-info

sessionInfo()
```
